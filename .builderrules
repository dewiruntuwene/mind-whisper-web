make the code clean, and structure